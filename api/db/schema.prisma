datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model TrainingTag {
  name     String     @id
  Training Training[]
}

enum BallType {
  CUE_BALL
  COLORED_BALL
  NUMBERED_BALL
}

model Ball {
  id               Int               @id @default(autoincrement())
  type             BallType
  color            String?
  number           Int?
  positionnedBalls PositionnedBall[]
}

model PositionnedBall {
  id       Int     @id @default(autoincrement())
  row      Int
  column   Int
  ball     Ball    @relation(fields: [ballId], references: [id])
  ballId   Int
  layout   Layout @relation(fields: [layoutId], references: [id])
  layoutId Int
}

model Layout {
  id              Int               @id @default(autoincrement())
  gridRowLevel    Int
  gridColumnLevel Int
  balls           PositionnedBall[]
  trainingBloc    TrainingBloc[]
}

enum TrainingBlocType {
  TABLE_LAYOUT
  RICH_TEXT
}

model TrainingBloc {
  id         Int              @id @default(autoincrement())
  type       TrainingBlocType
  title      String           @unique
  text       String?
  layout     Layout?          @relation(fields: [layoutId], references: [id])
  layoutId   Int?
  training   Training         @relation(fields: [trainingId], references: [id])
  trainingId Int
}

model Training {
  id    Int            @id @default(autoincrement())
  name  String         @unique
  tags  TrainingTag[]
  blocs TrainingBloc[]
}
